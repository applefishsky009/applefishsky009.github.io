---
title: 五种变量存储方式与external关键字
date: 2016-04-06 17:15:14
category: C++基础
tags: [变量存储,external关键字]

---

## 五种变量存储方式

| 存储描述		| 持续性	| 作用域	| 链接性	| 如何声明					|
| :-----------:	| :---:	| :---:	| :---: | :-------------------:		|
| 自动			| 自动	| 代码块	| 无		| 代码块中					|
| 寄存器			| 自动	| 代码块	| 无		| 代码块中，`register`			|
| 静态，无链接性	| 静态	| 代码块	| 无		| 代码块中，`static`			|
| 静态，外部连接性| 静态	| 文件	| 外部	| 不在任何代码块中，无关键字	|
| 静态，内部链接性| 静态	| 文件	| 内部	| 不在任何代码块中，`static`	|	

+ `register`用于显示指出自动变量，没什么用处，C++11保留的目的是向下兼容；
+ 静态无链接性变量与自动变量的异同：
	+ 静态无链接性变量在编译器**编译**时，编译器在**静态/全局存储区**分配内存；
	+ 自动变量在代码块**运行**时，编译器在**栈**中分配内存；
	+ 二者均只能在代码块中运行。

---

## external关键字

变量的声明有两种：定义声明（简称为定义）与引用声明（简称为声明）。如果要在一个文件中使用另一个文件中定义声明的变量，仅仅将这个变量储存为外部链接性的静态变量是不够的，还要在引用的文件中使用`external`关键字做**引用声明**。

1. 外部变量在`main()`前面或头文件中定义它，在文件中定义之后的任何位置使用它；
2. 单定义规则：变量只能定义声明一次；
3. 局部变量隐藏同名的全局变量。如果要访问全局变量，可用作用域解析符`：：`；
4. 静态变量将隐藏常规外部变量（使用`external`关键字引用）。

关于`external`关键字的测试是很简单的，这里不给出代码。另外提到单定义规则，有一点需要注意。任何一个包含头文件的cpp都要重新编译这个头文件，因此头文件绝对不能包含函数体与变量。不然，两个或两个以上cpp包含它会出现重定义错误。

---


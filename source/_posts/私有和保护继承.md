---
title: 私有和保护继承
date: 2016-06-13 15:22:02
category: C++的类
tags: has-a

---

has-a关系，即新的类将包含另一个类的对象。有两种方式实现：
1. 包含；
2. 私有或保护继承。

多数情况下都使用包含：
1. 他易于理解；
2. 继承会引发很多问题(尤其是多基类)；

但继承也有优势：
1. 派生类可以访问保护成员；
2. 派生类可以重新定义虚函数。

---

## 包含

1. 公有继承可以继承接口和实现，但包含可以获得实现，不能获得接口；
	+ 公有继承获得接口的意思是可以在派生类通过函数原型来隐藏或重写(覆盖)原接口；
	+ 包含获得实现的意思是可以通过具体对象调用实现的方法。
2. 必须在构建对象的其他部分之前，先构建对象的所有成员对象。初始化被包含的对象通过初始化列表。

---

## 私有或保护继承

### 私有继承(默认)
基类的**一切**成员都将成为派生类的私有成员。
1. 包含版本提供显示命名的对象，而私有继承提供了两个无名称的子对象成员；
2. 构造函数使用成员初始化列表时，使用类名而不是成员名来标识构造函数(必要时使用作用于解析符)；
3. 只能在派生类的**方法**中使用基类方法(通过**类名和作用域解析符**)，包含使用**对象**来调用；
4. 使用强制类型转化`*this`(派生类本身)得到基类继承而来的无名对象；
5. 不能用作用域解析符使用友元函数(友元函数不属于类)，可以显式将派生类转化为基类引用来调用友元函数；
	+ 不能自动转化：**不显式转化**，派生类的引用/指针不能赋值给基类的引用/指针(反过来可以)；
	+ 不显式转化，可能会递归调用；
	+ MI时，无法确定转换哪个基类。 

### 保护继承
基类的公有成员和保护成员将成为派生类的保护成员。
1. 私有继承**第三代类**不能使用基类方法，而保护继承可以；
2. 私有与保护继承中，方法对类外不可见，若类外想使用，有两种方法：
	+ 定义一个使用基类方法的公有派生类方法；
	+ 使用`using`声明指出派生类可以使用的基类成员(即使是私有派生)，这相当于重定义了访问权限；
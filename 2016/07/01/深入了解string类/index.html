<!DOCTYPE html>


  <html class="light page-home">


<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>深入了解string类 | 孤云两角，去天一握</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="C++,">
  

  <meta name="description" content="之前由于编程过程中经常使用，在string类与cctype等博客中简单介绍过一些string相关的方法，迭代器，算法的用法。这篇主要是以一个类的角度深入系统地管理string类知识。可在cplus上的string查阅各种方法用法。  模板具体化string是模板basic_string&amp;lt;char&amp;gt;的一个typedef，basic_string有四个具体化，都有typedef名称： 12">
<meta name="keywords" content="C++">
<meta property="og:type" content="article">
<meta property="og:title" content="深入了解string类">
<meta property="og:url" content="https://applefishsky009.github.io/2016/07/01/深入了解string类/index.html">
<meta property="og:site_name" content="孤云两角，去天一握">
<meta property="og:description" content="之前由于编程过程中经常使用，在string类与cctype等博客中简单介绍过一些string相关的方法，迭代器，算法的用法。这篇主要是以一个类的角度深入系统地管理string类知识。可在cplus上的string查阅各种方法用法。  模板具体化string是模板basic_string&amp;lt;char&amp;gt;的一个typedef，basic_string有四个具体化，都有typedef名称： 12">
<meta property="og:locale" content="Chinese">
<meta property="og:updated_time" content="2020-05-13T12:18:58.455Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="深入了解string类">
<meta name="twitter:description" content="之前由于编程过程中经常使用，在string类与cctype等博客中简单介绍过一些string相关的方法，迭代器，算法的用法。这篇主要是以一个类的角度深入系统地管理string类知识。可在cplus上的string查阅各种方法用法。  模板具体化string是模板basic_string&amp;lt;char&amp;gt;的一个typedef，basic_string有四个具体化，都有typedef名称： 12">

  

  
    <link rel="icon" href="/favicon.ico">
  

  <link href="/css/styles.css?v=32204ee7" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css">
  

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-76667484-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics --><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</head>
</html>
<body>

  
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="ROUND_RECT"
            href="/archives/"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="ROUND_RECT"
            href="/category/"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="ROUND_RECT"
            href="/about/"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="ROUND_RECT"
            href="/tag/"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="ROUND_RECT"
            href="/link/"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="ROUND_RECT"
            href="/project/"
            target="_self"
            >
            项目
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="ROUND_RECT"
            href="/search/"
            target="_self"
            >
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#模板具体化"><span class="toc-text">模板具体化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#构造函数"><span class="toc-text">构造函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#输入"><span class="toc-text">输入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#一般的简单连续输入"><span class="toc-text">一般的简单连续输入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用字符串"><span class="toc-text">使用字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#比较"><span class="toc-text">比较</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#搜索"><span class="toc-text">搜索</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其他功能"><span class="toc-text">其他功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#重载的运算符"><span class="toc-text">重载的运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#重载"><span class="toc-text">[]重载</span></a></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-深入了解string类" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">深入了解string类</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2016.07.01</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>ryl</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/STL/">STL</a>
  </span>



      
        <span>
          <i class="icon-comment"></i>
          <a href="https://applefishsky009.github.io/2016/07/01/深入了解string类/#disqus_thread"></a>
        </span>
      

    </div>
  </header>

  <div class="article-content">
    
      <p>之前由于编程过程中经常使用，在<a href="http://rylcode.cn/2016/04/21/string%E4%B8%8Ecctype/" target="_blank" rel="noopener">string类与cctype</a>等博客中简单介绍过一些<code>string</code>相关的方法，迭代器，算法的用法。这篇主要是以一个类的角度深入系统地管理<code>string</code>类知识。可在<a href="http://www.cplusplus.com/reference/string/" target="_blank" rel="noopener">cplus上的string</a>查阅各种方法用法。</p>
<hr>
<h2 id="模板具体化"><a href="#模板具体化" class="headerlink" title="模板具体化"></a>模板具体化</h2><p><code>string</code>是模板<code>basic_string&lt;char&gt;</code>的一个typedef，<code>basic_string</code>有四个具体化，都有<code>typedef</code>名称：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">charT</span>, <span class="title">class</span> <span class="title">traits</span> = <span class="title">char_traits</span>&lt;charT&gt;, <span class="title">class</span> <span class="title">Allocator</span> = <span class="title">allocator</span>&lt;charT&gt; &gt;</span></span><br><span class="line"><span class="class"><span class="title">basic_string</span>&#123;</span>...&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> basic_string&lt;<span class="keyword">char</span>&gt; <span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">typedef</span> basic_string&lt;<span class="keyword">wchar_t</span>&gt; <span class="built_in">wstring</span>;</span><br><span class="line"><span class="keyword">typedef</span> basic_string&lt;<span class="keyword">char16_t</span>&gt; u16string;</span><br><span class="line"><span class="keyword">typedef</span> basic_string&lt;<span class="keyword">char32_t</span>&gt; u32string;</span><br></pre></td></tr></table></figure>

<ol>
<li><code>charT</code>表示选定字符类型；</li>
<li><code>traits</code>描述选定字符类型的特定情况(如值比较)；</li>
<li><code>Allocator</code>类管理内村分配，每种字符类类型，都有预定义(默认)的<code>allocator</code>模板具体化，使用<code>new</code>和<code>delete</code>。</li>
</ol>
<hr>
<h2 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">default</span> (<span class="number">1</span>)	<span class="built_in">string</span>();</span><br><span class="line">copy (<span class="number">2</span>)	<span class="built_in">string</span> (<span class="keyword">const</span> <span class="built_in">string</span>&amp; str);</span><br><span class="line">substring (<span class="number">3</span>)	<span class="built_in">string</span> (<span class="keyword">const</span> <span class="built_in">string</span>&amp; str, <span class="keyword">size_t</span> pos, <span class="keyword">size_t</span> len = npos);</span><br><span class="line">from c-<span class="built_in">string</span> (<span class="number">4</span>)	<span class="built_in">string</span> (<span class="keyword">const</span> <span class="keyword">char</span>* s);</span><br><span class="line"><span class="function">from <span class="title">buffer</span> <span class="params">(<span class="number">5</span>)</span>	<span class="title">string</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* s, <span class="keyword">size_t</span> n)</span></span>;</span><br><span class="line"><span class="built_in">fill</span> (<span class="number">6</span>)	<span class="built_in">string</span> (<span class="keyword">size_t</span> n, <span class="keyword">char</span> c);</span><br><span class="line">range (<span class="number">7</span>)	<span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">InputIterator</span>&gt;	//指针模板</span></span><br><span class="line"><span class="class">  			<span class="title">string</span>  (<span class="title">InputIterator</span> <span class="title">first</span>, <span class="title">InputIterator</span> <span class="title">last</span>);</span></span><br><span class="line"><span class="function">initializer <span class="title">list</span> <span class="params">(<span class="number">8</span>)</span>	<span class="title">string</span> <span class="params">(<span class="built_in">initializer_list</span>&lt;<span class="keyword">char</span>&gt; il)</span></span>;</span><br><span class="line"><span class="built_in">move</span> (<span class="number">9</span>)	<span class="built_in">string</span> (<span class="built_in">string</span>&amp;&amp; str) <span class="keyword">noexcept</span>;</span><br></pre></td></tr></table></figure>

<p>大部分很容易理解，特别说明的几个：</p>
<ol>
<li>(5)中从s指针开始位置开始构造n个字符，即使超过了NBTS(以空字符结束的字符串)；</li>
<li>(8)是为了普遍化列表初始化语法，其使用意义并不大；</li>
<li>(9)-移动构造函数与(2)的区别是不将<code>string</code>视为<code>const</code>，主要用来在一些情况下优化性能。</li>
</ol>
<hr>
<h2 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h2><p><code>string</code>对象有两种输入方式(<code>cin.getline()</code>和<code>cin.get()</code>是C风格的输入方式)：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> s;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;s;	<span class="comment">//read a word</span></span><br><span class="line">getline(<span class="built_in">cin</span>,s);	<span class="comment">//read a line, discard \n, 接受第三个参数作为分界符，默认\n</span></span><br></pre></td></tr></table></figure>

<p><code>getline()</code>的<code>string</code>版本是一个独立的函数而不是<code>istream</code>类的方法，他可以自动调整目标对象大小使之刚好存储，他受到两个条件限制：</p>
<ol>
<li><code>string</code>对象最大允许长度(<code>string::npos</code>)，通常是<code>unsigned int</code>最大值；</li>
<li>内存量大小。</li>
</ol>
<p>他在以下情况下停止读取：</p>
<ol>
<li>到达文件尾(EOF)，输入流<code>ios_base::iostate</code>设置为<code>ios::eof</code>(只有<code>ios::good</code>才能读取，<code>cin.clear()</code>可纠正)；</li>
<li>分界字符(默认为<code>\n</code>)；</li>
<li>读取字符数最大允许值<code>string::npos</code>(注意他的类型为<code>size_t</code>)，输入流<code>ios_base::iostate</code>设置为<code>ios::fail</code>.</li>
</ol>
<h3 id="一般的简单连续输入"><a href="#一般的简单连续输入" class="headerlink" title="一般的简单连续输入"></a>一般的简单连续输入</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> s;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; s &gt;&gt;i) &#123;	<span class="comment">//读入binding 123这种输入</span></span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> s;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; s) &#123;</span><br><span class="line">	<span class="keyword">if</span> (s == <span class="string">"end"</span>) <span class="keyword">break</span>;	<span class="comment">//end开头表示没有数字</span></span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; i;		<span class="comment">//从缓存区读入</span></span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="使用字符串"><a href="#使用字符串" class="headerlink" title="使用字符串"></a>使用字符串</h2><h3 id="比较"><a href="#比较" class="headerlink" title="比较"></a>比较</h3><p>主要是重载了关系运算符。</p>
<h3 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h3><p>以<code>find()</code>方法为例：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> (<span class="number">1</span>)	<span class="function"><span class="keyword">size_t</span> <span class="title">find</span> <span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; str, <span class="keyword">size_t</span> pos = <span class="number">0</span>)</span> <span class="keyword">const</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line">c-<span class="built_in">string</span> (<span class="number">2</span>)	<span class="function"><span class="keyword">size_t</span> <span class="title">find</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* s, <span class="keyword">size_t</span> pos = <span class="number">0</span>)</span> <span class="keyword">const</span></span>;</span><br><span class="line"><span class="built_in">buffer</span> (<span class="number">3</span>)	<span class="function"><span class="keyword">size_t</span> <span class="title">find</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* s, <span class="keyword">size_t</span> pos, size_type n)</span> <span class="keyword">const</span></span>;</span><br><span class="line">character (<span class="number">4</span>)	<span class="function"><span class="keyword">size_t</span> <span class="title">find</span> <span class="params">(<span class="keyword">char</span> c, <span class="keyword">size_t</span> pos = <span class="number">0</span>)</span> <span class="keyword">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<p>注意(3)中n表示限制了子串的长度。下列其他的方法原型类似：</p>
<ol>
<li><code>rfind()</code>找最后一次出现的位置；</li>
<li><code>find_first_of()</code>找参数中<strong>任何</strong>字符第一次出现的位置；</li>
<li><code>find_last_of</code>找参数中<strong>任何</strong>字符最后一次出现的位置’</li>
<li><code>find_first_not_of</code>找字符串中第一个不在参数串中的字符位置；</li>
<li><code>find_last_not_of</code>找字符串中最后一个不在参数串中的字符位置。</li>
</ol>
<p>注意以上不管是什么寻找方法(<code>first</code>类寻找或者<code>last</code>类寻找)，找不到都会返回<code>string::npos</code>;</p>
<hr>
<h2 id="其他功能"><a href="#其他功能" class="headerlink" title="其他功能"></a>其他功能</h2><p>列出功能提纲，如有需要可以扩充上一目录中：</p>
<ol>
<li>删除(erase)；</li>
<li>替换(replace)；</li>
<li>插入(insert)；</li>
<li>提取(substring)；</li>
<li>复制(copy)；</li>
<li>交换(swap)；</li>
</ol>
<hr>
<h2 id="重载的运算符"><a href="#重载的运算符" class="headerlink" title="重载的运算符"></a>重载的运算符</h2><ol>
<li><code>+</code>；</li>
<li><code>=</code>；</li>
<li><code>+=</code>;</li>
<li><code>[]</code>;</li>
<li><code>&gt;&gt;</code>;</li>
<li><code>&gt;&gt;</code>;</li>
<li>关系运算符。</li>
</ol>
<h3 id="重载"><a href="#重载" class="headerlink" title="[]重载"></a>[]重载</h3><p>三观尽毁，先来一个概念<a href="https://en.wikipedia.org/wiki/Null-terminated_string" target="_blank" rel="noopener">Null-terminated string</a>,再来参考文档<a href="http://www.cplusplus.com/reference/string/string/operator[]/" target="_blank" rel="noopener">operator[]</a>。解释一下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> s;</span><br><span class="line"><span class="keyword">bool</span> flag = s[s.<span class="built_in">size</span>()] == <span class="string">'\0'</span>；</span><br></pre></td></tr></table></figure>

<ol>
<li><code>s[s.size()]</code>不会抛出异常，调试时监视器提示越界(坑，越界是没错，但其有值!)</li>
<li><code>flag</code>等于<code>true</code>，也就是说<code>s[s.size()]</code>的值为<code>&#39;\0&#39;</code>。</li>
</ol>

    
  </div>
</article>

</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="ROUND_RECT"
              href="/archives/"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="ROUND_RECT"
              href="/category/"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="ROUND_RECT"
              href="/about/"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="ROUND_RECT"
              href="/tag/"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="ROUND_RECT"
              href="/link/"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="ROUND_RECT"
              href="/project/"
              target="_self"
              >
              项目
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="ROUND_RECT"
              href="/search/"
              target="_self"
              >
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    
  <section class="disqus-comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </section>

  <script>
    var disqus_shortname = 'rylcode';
    
    var disqus_url = 'https://applefishsky009.github.io/2016/07/01/深入了解string类/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>

  <script id="dsq-count-scr" src="//rylcode.disqus.com/count.js" async></script>



    




  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235687', function() {
      // load success
    });
  }
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
